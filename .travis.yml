jobs:
  include:
  - os: linux
    name: Ubuntu 18.04 Tests
    env: BUILD=UBUNTU18
    dist: bionic
    language: python
    python: 3.6
    before_script: pip3 install -r requirements.txt
    script: nosetests
    before_deploy: ./build.sh Ubuntu18
  - os: linux
    name: Ubuntu 20.04 Tests
    env: BUILD=UBUNTU20
    dist: focal
    language: python
    python: 3.6
    before_script: pip3 install -r requirements.txt
    script: nosetests
    before_deploy: ./build.sh Ubuntu20
  - os: osx
    name: Mac 10.15 Tests
    env: BUILD=MAC
    osx_image: xcode11.4
    before_script: pip3 install --user -r requirements.txt
    script: "/Users/travis/Library/Python/3.7/bin/nosetests"
    before_deploy: ./build.sh Mac
  - os: windows
    name: Windows Tests
    env: BUILD=WINDOWS PATH=/c/Python36:/c/Python36/Scripts:$PATH
    language: cpp
    before_script:
    - choco install 7zip
    - choco install python --version 3.6.8
    - pip3 install -r requirements.txt
    script: nosetests
    before_deploy: ./build.sh Windows
  - os: linux
    name: Flake8
    env: BUILD=FLAKE8
    dist: bionic
    language: python
    python: 3.6
    before_script: pip3 install -r requirements.txt
    script: flake8 epregressions
  - os: linux
    name: PyPi Packaging
    dist: focal
    env: BUILD=PYPI
    language: python
    python: 3.6
    before_script: pip3 install -r requirements.txt
    script: python3 setup.py bdist_wheel sdist

deploy:
- provider: releases
  api_key:
    secure: dtm5qvOwBnYI37k0X5bQ1tJweOs5UTV65vv1vGa+TaU8eAE1KHmTIhNedZg7aRWYSpLRz/hdhGPjVBxid7VIvtIqFI4HX6wJ9Mf6aFL6uoFM5mUhtBrBo7TkcYG+oSQ5eftCDVO0449iKi0mzXgfl5szNXns1/VthK15+MGBQr12hNu+l0aWG3gWyweUnpJ3x4nORXU01v3yLTl+4J/UNOBzJvziXNub/7idF+v//hsoesLJuwKUjUBRmCackTFEiO/t9Atr4fMbI9Fksd+8TBaYplwz6ZwqKKtI1itrAe9af2PRTic7ZWmLI36U5KrGkH6yERFY2MAOgwHmirlkKfPknW1zLxaBMtgimdMhM9iVhNShC6+D1OpwFxiQEleQvS7ASFGLHeBuK2YK5QTH/4e9j1hGcaIrBg/J3JCPr9EYcqS2shUu0DxOyfQzI/M5vWDcY/suwZb0hijqXYDg9T+qIxdmlzV7RFwj6cSsVKvpLJSoAgZmoEAruze+iCp4jKdP/mEyvslbcLYt4MeGv8BydcX6jaLTgqMFYg3cZuWKATT6KVc6DaaL+Ptc5kIhw7GHMfkFyVe9lRAKiDDvvV1VIrnSyYcJ1m+i5XdSe5/IeCMuj0aTx1iTa0gi4CoKLIdWYvAbbGGjj9s8VT7nxH4c4WPosKabPyM1pt7MDPk=
  file_glob: true
  file: deploy/*
  skip_cleanup: true
  overwrite: true
  on:
    tags: true
    repo: NREL/EnergyPlusRegressionTool
    condition: $BUILD != PYPI
- provider: pypi
  user: Myoldmopar
  skip_cleanup: true
  skip_upload_docs: true
  username: "__token__"
  password:
    secure: "aec5eRMyUdV0BuDfamO9PfiEG0lYmWsL8KpmDNVi7XVYAw+CVa2q5IqRjO1YBslOKVylTnwtTAIbPStYIRjoFac1lxvRXHGvGEE2YUURJqMiztYVHzTcDAsJXOH6JXTkI+4zQbiemTOqMLee8p2xwX6tpdTseQzMcWF9EIjLfiml4l89zdueYJW5ODp4g4LI6kMEe45TI26Mynxnr4MhUF8N7TCItWQFIa6DNHQ+3rysbHEoAiht27lzKvdhdBlVMs3vS/+/A3GMJ1HGf6avkBBp2JsFM1yDFLbCDVsiFMziqO7F8m3H8w0kTr6jgjkfafjLk71kuT9ZCd8wXgUP85nEKNUig50WkSsWfgftXcIWA8wmXo2PN2lwWpEYlvOUSsTAFMpyBfXi1jeeDrLVgalHS0yHpPkZ3VYj1rSOCOnZ+032Lshy+SQO75nJNovvIFZHmFxN4a2DI+YYTZYHvI1FzNtYmwTenCQTT08QonbOfFtvrl4sEMapGenmr3npIELJXL6TqWK93BtVcb39usBJZbIuOTiz6ZN4Cel7rAynVo1jmFSfZ8lg8H4WMDN3pWTCD0slwhOHSRydMsEIhDLVb7dNOqhOQnuLBaf9Y5XNcVaJS69seqFOYB0bSvRF8SKXRBSpIsxAcFGz6xyUlyqts2aaDRe/zAZYK6rBrIM="
  on:
    tags: true
    distributions: sdist bdist_wheel
    repo: NREL/EnergyPlusRegressionTool
    condition: $BUILD = PYPI
